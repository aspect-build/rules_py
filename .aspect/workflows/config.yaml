# See https://docs.aspect.build/workflows/configuration
---
workspaces:
  - .
  - e2e/smoke
  - e2e/repository-rule-deps
  - e2e/system-interpreter
  - examples/uv_pip_compile

tasks:
  - test:
      name: test-os:linux-bzl:head
      queue: aspect-default
      hooks:
        - type: before_task
          command: |
            echo "last_green" > .bazelversion

  # - test:
  #     name: test-os:mac-bzl:head
  #     queue: mac-runners
  #     hooks:
  #       - type: before_task
  #         command: |
  #           echo "last_green" > .bazelversion

  - test:
      name: test-os:linux-bzl:latest
      queue: aspect-default
      hooks:
        - type: before_task
          command: |
            echo "latest" > .bazelversion

  # - test:
  #     name: test-os:mac-bzl:8
  #     queue: mac-runners
  #     hooks:
  #       - type: before_task
  #         command: |
  #           echo "8" > .bazelversion

  - test:
      name: test-os:linux-bzl:8
      queue: aspect-default
      hooks:
        - type: before_task
          command: |
            echo "8.2.1" > .bazelversion

  - test:
      name: test-os:linux-bzl:7
      queue: aspect-default
      hooks:
        - type: before_task
          command: |
            echo "7.6.1" > .bazelversion

  # - test:
  #     name: test-os:mac-bzl:7
  #     queue: mac-runners
  #     hooks:
  #       - type: before_task
  #         command: |
  #           echo "7" > .bazelversion

  - test:
      name: test-os:linux-bzl:6
      queue: aspect-default
      hooks:
        - type: before_task
          command: |
            echo "6.5.0" > .bazelversion

  # - test:
  #     name: test-os:mac-bzl:6
  #     queue: mac-runners
  #     hooks:
  #       - type: before_task
  #         command: |
  #           echo "6" > .bazelversion
